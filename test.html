<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>witz.js</title>
    <script type="module">
      import "https://thewhodidthis.github.io/cutaway/main.js"
      import { assert, report } from "https://thewhodidthis.github.io/tapeless/main.js"
      import witz from "./main.js"

      const image = new Image()

      image.onload = () => {
        const context = document.createElement("canvas").getContext("2d")

        context.drawImage(image, 0, 0)
        context.canvas.toBlob((blob) => {
          blob.arrayBuffer().then((b) => {
            const d = new Uint8Array(b)
            const filter = witz(d)
            const o = filter()

            assert.equal
              .describe("returns lambda on init")
              .test(typeof filter, "function")

            assert.ok
              .describe("output type is a match")
              .test(typeof result, "Uint8Array")

            report()
          })
        }, "image/jpeg")
      }

      image.src = "data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABmJLR0T///////8JWPfcAAAACXBIWXMAAABIAAAASABGyWs+AAAAF0lEQVRIx2NgGAWjYBSMglEwCkbBSAcACBAAAeaR9cIAAAAASUVORK5CYII="
    </script>
  </head>
  <body></body>
</html>
